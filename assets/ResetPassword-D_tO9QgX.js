import{r as e,u as h,b as w,j as n,a as y,n as x}from"./index-DeG2Pli5.js";import{a as T,b as j}from"./TextComponent-CTwhpzvN.js";import{A as k}from"./AuthForm-DzUG9YGF.js";import{N as L}from"./NotifToast-B4gOep3X.js";import"./Logo-C-Zzoyrl.js";function S(){const s=e.useRef([]),[o,i]=e.useState(),f=h(),u=w(),[m,c]=e.useState(!1),v="http://127.0.0.1:3000",[d,l]=e.useState({message:"",status:""}),[p,g]=e.useState();e.useEffect(()=>{document.title="ساخت رمز عبور جدید"},[]);const b=async()=>{var r;(r=s==null?void 0:s.current)==null||r.map(a=>{a.value===""?T(t=>{i(t)},a.getAttribute("data-label"),a.value,o,a.type):g(a.value)})};return e.useEffect(()=>{var a;const r=async()=>{try{c(!0);const t=await y.post(`${v}/resetPassword/${u.token}`,{password:s==null?void 0:s.current[0].value,passwordConfirm:s==null?void 0:s.current[1].value},{headers:{Authorization:`Bearer ${u.token}`}});t!==void 0&&(t.data.status==="success"&&l({message:"رمز عبور شما تغییر کرد",status:"success"}),j.remove("user-pass"),x("/login","",f))}catch(t){c(!1),t&&l({message:"رمز عبور موقتی وجود ندارد یا منقضی شده",status:"fail"})}};p&&(o&&((a=Object==null?void 0:Object.keys(o))==null?void 0:a.length)==0||o===void 0)&&r()},[p]),n.jsxs(n.Fragment,{children:[d.message&&n.jsx(L,{setNotif:l,notif:d}),n.jsx(k,{fieldes:[{label:"رمز عبور",type:"password",valueType:"password"},{label:"تکرار رمز عبور",type:"password",valueType:"password"}],handleBtn:b,headerLabel:"ساخت رمز عبور جدید",inputRefs:s,validation:o,setValidation:i,loading:m,otherLink:[{label:"فراموشی رمز عبور!",link:"/forgetPassword"}],btnLabel:"ارسال"})]})}export{S as default};
