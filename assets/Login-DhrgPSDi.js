import{r as t,u as h,j as l,a as y,n as x}from"./index-DeG2Pli5.js";import{a as L,b as T}from"./TextComponent-CTwhpzvN.js";import{A as j}from"./AuthForm-DzUG9YGF.js";import{N as w}from"./NotifToast-B4gOep3X.js";import"./Logo-C-Zzoyrl.js";function V(){const a=t.useRef([]),[s,i]=t.useState(),f=h(),m="http://127.0.0.1:3000",[g,u]=t.useState(!1),[c,d]=t.useState({message:"",status:""}),[p,v]=t.useState();t.useEffect(()=>{document.title="ورود کاربر"},[]);const b=async()=>{var o;(o=a==null?void 0:a.current)==null||o.map(e=>{e.value===""?L(r=>{i(r)},e.getAttribute("data-label"),e.value,s,e.type):v(e.value)})};return t.useEffect(()=>{var e;const o=async()=>{var r;try{u(!0);const n=await y.post(`${m}/api/users/login`,{email:a==null?void 0:a.current[0].value,password:a==null?void 0:a.current[1].value},{withCredentials:!0});n!==void 0&&(n.data.status==="success"&&T.remove("user-pass"),x("/dashboard","",f))}catch(n){u(!1),((r=n.response)==null?void 0:r.status)!==200&&d({message:"کاربری با این مشخصات یافت نشد",status:"fail"})}};p&&(s&&((e=Object==null?void 0:Object.keys(s))==null?void 0:e.length)==0||s===void 0)&&o()},[p]),l.jsxs(l.Fragment,{children:[c.message&&l.jsx(w,{setNotif:d,notif:c}),l.jsx(j,{fieldes:[{label:"ایمیل",type:"email",valueType:"email"},{label:"رمز عبور",type:"password",valueType:"password"}],handleBtn:b,headerLabel:"ورود کاربر",inputRefs:a,validation:s,setValidation:i,loading:g,otherLink:[{label:"هنوز ثبت نام نکردی؟",link:"/register"},{label:"رمز عبورتو فراموش کردی؟",link:"/forgetPassword"}],btnLabel:"ورود"})]})}export{V as default};
