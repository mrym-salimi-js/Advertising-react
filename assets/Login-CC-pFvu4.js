import{r as t,u as h,j as l,a as x,n as y}from"./index-BZ_Dsnwq.js";import{a as w,b as L}from"./TextComponent-DJFMzBJi.js";import{A as T}from"./AuthForm-BHYHCprh.js";import{N as j}from"./NotifToast-DAqZWmjw.js";import"./Logo-BKDSPWJk.js";function V(){const a=t.useRef([]),[s,i]=t.useState(),m=h(),f="https://pensive-volhard-wbilxm8r4.liara.run",[v,u]=t.useState(!1),[c,d]=t.useState({message:"",status:""}),[p,g]=t.useState();t.useEffect(()=>{document.title="ورود کاربر"},[]);const b=async()=>{var o;(o=a==null?void 0:a.current)==null||o.map(e=>{e.value===""?w(r=>{i(r)},e.getAttribute("data-label"),e.value,s,e.type):g(e.value)})};return t.useEffect(()=>{var e;const o=async()=>{var r;try{u(!0);const n=await x.post(`${f}/api/users/login`,{email:a==null?void 0:a.current[0].value,password:a==null?void 0:a.current[1].value},{withCredentials:!0});n!==void 0&&(n.data.status==="success"&&L.remove("user-pass"),y("/dashboard","",m))}catch(n){u(!1),((r=n.response)==null?void 0:r.status)!==200&&d({message:"کاربری با این مشخصات یافت نشد",status:"fail"})}};p&&(s&&((e=Object==null?void 0:Object.keys(s))==null?void 0:e.length)==0||s===void 0)&&o()},[p]),l.jsxs(l.Fragment,{children:[c.message&&l.jsx(j,{setNotif:d,notif:c}),l.jsx(T,{fieldes:[{label:"ایمیل",type:"email",valueType:"email"},{label:"رمز عبور",type:"password",valueType:"password"}],handleBtn:b,headerLabel:"ورود کاربر",inputRefs:a,validation:s,setValidation:i,loading:v,otherLink:[{label:"هنوز ثبت نام نکردی؟",link:"/register"},{label:"رمز عبورتو فراموش کردی؟",link:"/forgetPassword"}],btnLabel:"ورود"})]})}export{V as default};
