import{r as e,u as h,j as l,a as y,n as x}from"./index-BzOAfmGi.js";import{a as L,b as T}from"./TextComponent-BkWP5nvC.js";import{A as j}from"./AuthForm-D2UDoT1D.js";import{N as w}from"./NotifToast-DdQsXZGT.js";import"./Logo-B44iCCyT.js";import"./SpinnerLoading-DE0fHWrO.js";function A(){const a=e.useRef([]),[s,i]=e.useState(),m=h(),f="http://127.0.0.1:3000",[g,u]=e.useState(!1),[c,d]=e.useState({message:"",status:""}),[p,v]=e.useState();e.useEffect(()=>{document.title="ورود کاربر"},[]);const b=async()=>{var o;(o=a==null?void 0:a.current)==null||o.map(t=>{t.value===""?L(r=>{i(r)},t.getAttribute("data-label"),t.value,s,t.type):v(t.value)})};return e.useEffect(()=>{var t;const o=async()=>{var r;try{u(!0);const n=await y.post(`${f}/api/users/login`,{email:a==null?void 0:a.current[0].value,password:a==null?void 0:a.current[1].value},{withCredentials:!0});n!==void 0&&(n.data.status==="success"&&T.remove("user-pass"),x("/dashboard","",m))}catch(n){u(!1),((r=n.response)==null?void 0:r.status)!==200&&d({message:"کاربری با این مشخصات یافت نشد",status:"fail"})}};p&&(s&&((t=Object==null?void 0:Object.keys(s))==null?void 0:t.length)==0||s===void 0)&&o()},[p]),l.jsxs(l.Fragment,{children:[c.message&&l.jsx(w,{setNotif:d,notif:c}),l.jsx(j,{fieldes:[{label:"ایمیل",type:"email",valueType:"email"},{label:"رمز عبور",type:"password",valueType:"password"}],handleBtn:b,headerLabel:"ورود کاربر",inputRefs:a,validation:s,setValidation:i,loading:g,otherLink:[{label:"هنوز ثبت نام نکردی؟",link:"/register"},{label:"رمز عبورتو فراموش کردی؟",link:"/forgetPassword"}],btnLabel:"ورود"})]})}export{A as default};
