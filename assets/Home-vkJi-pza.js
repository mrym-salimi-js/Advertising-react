import{j as e,w as ee,L as B,x as he,U as te,r as l,y as $,u as T,z as q,C as D,v as ge,A as R,n as U,b as I,B as be,D as je,t as me,E as ve,F as ye,X as Ce,G as we,a as se,P as Se}from"./index-CbeBIUc8.js";import{A as Ne}from"./AdCart-CgK1N6Um.js";import{L as ke}from"./Logo-C0IGYkvB.js";import{B as O,d as W,a as Le,b as Ae,S as Fe,T as re,L as ze}from"./SingleSelected-DeuCgH6Z.js";import{a as $e,u as Oe}from"./updateUserStatus-yb8RbKHN.js";import{T as M}from"./TextComponent-Cno3bZzp.js";function Ee(){const t=s=>{document.querySelectorAll(".nav-li").forEach(n=>{n.children[0].classList.remove("text-[#84105C]")}),s.children[0].classList.add("text-[#84105C]")};return e.jsx("nav",{className:"w-[97%] border  h-16 xl:hidden rounded-2xl mb-3 shadow-lg bg-white border-[#f3f3f3] fixed bottom-0  m-auto left-0 right-0 z-[1000] py-8",children:e.jsxs("ul",{className:"w-full h-full flex gap-2 justify-around items-center",children:[e.jsx("li",{className:"nav-li h-full flex items-center cursor-pointer  ",children:e.jsxs("a",{href:"/s/iran",onClick:s=>t(s.currentTarget),className:"flex flex-col gap-2 items-center",children:[e.jsx(ee,{color:"#84105C",size:"size-6"}),e.jsx("p",{className:"text-[0.7rem] text-[#84105C]",children:"آگهی ها"})]})}),e.jsx("li",{className:"nav-li h-full flex  items-center cursor-pointer",children:e.jsxs(B,{to:"/newad",onClick:s=>t(s.currentTarget),className:"flex flex-col gap-2 items-center",children:[e.jsx(he,{color:"#84105C ",size:"size-10 relative bottom-5"}),e.jsx("p",{className:"text-[0.7rem] text-gray-500 relative bottom-2",children:"ثبت آگهی جدید"})]})}),e.jsx("li",{className:"nav-li h-full flex items-center  cursor-pointer ",children:e.jsxs(B,{to:"/dashboard",onClick:s=>t(s.currentTarget),className:"flex flex-col gap-2 items-center",children:[e.jsx(te,{color:"#858383",size:"size-6"}),e.jsx("p",{className:"text-[0.7rem] text-gray-500",children:"حساب من"})]})})]})})}function X(t){let s=!1,r=0,n;t.forEach(o=>{o.addEventListener("mousedown",i=>{s=!0,!(r>0)&&(r=i.pageX-o.offsetLeft,n=o.scrollLeft)}),o.addEventListener("mouseleave",()=>{s=!1}),window.addEventListener("mouseup",()=>{s=!1}),o.addEventListener("mousemove",i=>{if(!s)return;const u=i.pageX-o.offsetLeft-r;o.scrollLeft=n-u})})}function K(){const[t,s]=l.useState();return l.useEffect(()=>{const r=JSON.parse(localStorage.getItem("ads_categories_list"));r&&s(r)},[]),t}function Pe(){const t=K(),s=()=>[X(document.querySelectorAll(".cat-items-box"))];return e.jsx("div",{onClick:s,id:"places-category-box",className:"w-[98%] h-[130px] py-1 px-4 rounded-xl z-[1000] bg-white  ",children:e.jsx("div",{className:"cat-items-box w-full h-full overflow-x-scroll ul-box",children:e.jsx("ul",{id:"places-category-ul",className:"w-auto py-3 px-1 flex gap-6 m-0",children:t==null?void 0:t.map(r=>e.jsxs("li",{className:"min-w-[92px] flex flex-col items-center gap-2 p-2",children:[e.jsx(B,{to:`/s/iran/${r.slug}`,className:"w-full p-2 bg-gray-50 rounded-3xl cursor-pointer flex flex-col gap-3 justify-center items-center",children:e.jsx("img",{className:"w-14 h-14 ",src:r.iconURL})}),e.jsx("p",{className:"text-black text-[0.7rem] py-1 px-2 text-center",children:r.name})]},r.id))})})})}function Ue({adsList:t}){return e.jsx("div",{className:"w-full h-auto p-2 ",children:e.jsx("div",{className:"w-full h-auto p-2 ",children:e.jsx("ul",{className:`w-full h-auto flex flex-wrap gap-y-16 gap-x-6 ${(t==null?void 0:t.length)>=4?"justify-evenly":"justify-evenly md:justify-start"}`,children:t&&(t==null?void 0:t.map(s=>e.jsx(Ne,{adItem:s},s._id)))})})})}function Be(){const t=$(),s=T(),[r]=q(),n=Object.fromEntries(r.entries()),o=new URLSearchParams(t.search),{setFilterFormDisplay:i}=l.useContext(w),d=()=>{W(n,o,s,t),i("opacity-0 invisible")};return e.jsxs("div",{className:"w-full h-30 p-8 flex items-center justify-between border-b ",children:[e.jsx("p",{className:"text-lg lg:text-xl",children:"فیلتر"}),e.jsx(O,{lable:"حذف فیلتر",handleAction:d,borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]"})]})}function ne({prvName:t,prvId:s}){const{setLocSituation:r,setPrvId:n,setPrvName:o,setSearchRes:i}=l.useContext(A),d=()=>{i([]),r("شهر"),n(s),o(t)};return e.jsx(e.Fragment,{children:e.jsxs("li",{onClick:d,className:"p-2 border-r-2 cursor-pointer border-pink-400 flex justify-between items-center ",children:[e.jsx("p",{className:"text-sm",children:t}),e.jsx(D,{color:"#000000",size:"size-5"})]},s)})}function le(){const[t,s]=l.useState();return l.useEffect(()=>{const r=JSON.parse(localStorage.getItem("ads_locations_list"));r&&s(r)},[]),t}function Te(){const t=le();return e.jsx("div",{className:"h-[59%] p-1 border-t-2 border-gray-100 mt-[20px] overflow-scroll ",children:e.jsx("ul",{className:"flex flex-col gap-2 p-2",children:t==null?void 0:t.map(s=>e.jsx(ne,{prvName:s.name,prvId:s.id},s.id))})})}function _e(){return JSON.parse(localStorage.getItem("ads_locations_list"))}function oe(){const t=_e();return t==null?void 0:t.map(r=>r)}function ae(){const t=oe(),s=[];return t==null||t.map(r=>{r.children.map(n=>{s.push(n)})}),s}function Re(){const{setAllCheckedBoxes:t,setCheck:s,setDeleteAllBtnClicked:r,setRemovedAllLocs:n}=l.useContext(A),o=()=>{r(!0),s([]),t([]),n(!0)};return e.jsx("div",{className:"w-auto h-auto px-3",children:e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]",textSize:"text-[0.7rem]",lable:"حذف همه",handleAction:o})})}function Ke(){const{setAllCheckedBoxes:t,allCheckedBoxes:s,setDeleteAllBtnClicked:r}=l.useContext(A),n=o=>{const i=s.filter(d=>{if((d==null?void 0:d.name)!==o)return d});t(i),r(!0)};return e.jsx("div",{className:"w-full overflow-scroll",children:e.jsx("ul",{className:"flex gap-3 py-2 items-center justify-start",children:s==null?void 0:s.map((o,i)=>o!==void 0&&e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]",textSize:"text-[0.7rem]",lable:o==null?void 0:o.name,handleAction:()=>n(o==null?void 0:o.name,o.id),icon:e.jsx(ge,{color:"#84105C",size:"size-5",strokeWidth:"2"})},i))})})}function De(){const{prvId:t,locSituation:s,prvName:r,setSearchRes:n}=l.useContext(A);let o=`جستجو در ${s} ها  `,i=r&&s==="شهر"?o+r:o;const[d,u]=l.useState(),c=g=>{const p=g.target.value;u(p);const f=oe();let h=[];t===void 0&&(h=f==null?void 0:f.filter(m=>m.name.includes(d)));const x=f.filter(m=>{if(m.id==t)return m.children});let b=[];x.length>0&&h.length==0&&(b=x[0].children.filter(m=>m.name.includes(d)));let j=p?[...b,...h]:[];n(j)};return e.jsx(Le,{handleInputValue:c,plcVal:i})}function ce({name:t,id:s}){const{setAllCheckedBoxes:r,allCheckedBoxes:n,prvId:o,check:i,setCheck:d}=l.useContext(A),u=g=>{let p=!1;return n==null||n.forEach(f=>{(f==null?void 0:f.name)===g&&(p=!0)}),p},c=(g,p,f)=>{const h=i.filter(x=>x!=o);if(d(h),r(x=>[...x,{name:f,id:p,province_id:o}]),!g.checked){const x=n.filter(b=>b.name!==g.getAttribute("data-city-name"));r(x)}};return e.jsxs("li",{className:"cursor-pointer flex justify-between items-center ",children:[e.jsx("p",{className:"text-sm p-1 pr-2 border-r-2  border-pink-400",children:t}),e.jsx("div",{className:"inline-flex items-center",children:e.jsxs("label",{className:"relative flex items-center p-3 rounded-full cursor-pointer",htmlFor:"check",children:[e.jsx("input",{checked:u(t),onChange:g=>c(g.target,s,t),"data-city-name":t,"data-city-id":s,type:"checkbox",className:"checkBox before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-pink-900 checked:bg-[#84105C] checked:before:bg-[#84105C] hover:before:opacity-10",id:"check"}),e.jsx("span",{className:"absolute text-white transition-opacity opacity-0 pointer-events-none top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 peer-checked:opacity-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"})})})]})})]})}function qe(){const{searchRes:t}=l.useContext(A);return e.jsx("div",{className:"h-[59%] p-1 border-t-2 border-gray-100 mt-[20px] overflow-scroll ",children:e.jsx("ul",{className:"flex flex-col gap-2 p-2",children:t.map((s,r)=>(s==null?void 0:s.children)===void 0?e.jsx(ce,{name:s.name,id:s.id},r):e.jsx(ne,{prvName:s.name,prvId:s.id},r))})})}function Ie(){const{setOpenLocation:t,allCheckedBoxes:s,setCookie:r,check:n,deleteAllBtnClicked:o,removeCookie:i,removedAllLocs:d}=l.useContext(A),u=[];s==null||s.forEach(g=>{u.push(g==null?void 0:g.id)});const c=()=>{n&&r("provinces",n),s&&r("cities",u),d!=!1&&(i("provinces"),i("cities")),t("opaciti-0 invisible")};return e.jsxs("div",{className:"w-[93%] p-4 flex flex-row-reverse gap-2 justify-start bg-white items-center absolute bottom-0 ",children:[e.jsx("button",{onClick:c,className:(s==null?void 0:s.length)>0||o?"hover:opacity-[0.8] w-20 p-3 outline-none text-white bg-[#84105C] rounded-lg text-sm ":"text-gray-300 w-20 p-3 bg-gray-100 rounded-lg text-sm hover:opacity-[0.8] outline-none cursor-not-allowed",children:"تایید"}),e.jsx("button",{onClick:()=>t("opaciti-0 invisible"),className:"w-20 border p-3  bg-gray-200 rounded-lg text-sm",children:"انصراف"})]})}function He(t){return l.useMemo(()=>{let r;const n=JSON.parse(localStorage.getItem("ads_locations_list"));return n&&n.forEach(o=>{o.id==t&&(r=o.children)}),r},[])}function Je(){const{prvId:t,prvName:s,setCheck:r,check:n,setAllCheckedBoxes:o,allCheckedBoxes:i,searchRes:d}=l.useContext(A),u=He(t),c=d[0]?d:u,g=()=>{const f=document.getElementById("all-check");if(t&&r([...n,t]),u==null||u.forEach(h=>{h!==void 0&&o(x=>[...x,{name:h.name,id:h.id,province_id:t}])}),!f.checked){const h=i.filter(b=>b.province_id!=t);o(h);const x=n.filter(b=>b!=t);r(x)}},p=f=>{let h=!1;return n==null||n.map(x=>{x==f&&(h=!0)}),h};return e.jsx("div",{className:"h-[65%] p-1 border-t-2 border-gray-100 mt-[20px] overflow-scroll ",children:e.jsxs("ul",{className:"flex flex-col p-2",children:[e.jsxs("li",{className:"cursor-pointer flex justify-between items-center border-b-[1px] pb-2",children:[e.jsxs("p",{className:"text-sm p-1 pr-2 border-r-4  border-pink-400",children:[" ","همه شهر های ",s]}),e.jsx("div",{className:"inline-flex items-center",children:e.jsxs("label",{className:"relative flex items-center p-3 rounded-full cursor-pointer",htmlFor:"check",children:[e.jsx("input",{readOnly:!0,checked:p(t),onClick:g,type:"checkbox",className:"before:content[''] peer relative h-5 w-5 cursor-pointer appearance-none rounded-md border border-blue-gray-200 transition-all before:absolute before:top-2/4 before:left-2/4 before:block before:h-12 before:w-12 before:-translate-y-2/4 before:-translate-x-2/4 before:rounded-full before:bg-blue-gray-500 before:opacity-0 before:transition-opacity checked:border-pink-900 checked:bg-[#84105C] checked:before:bg-[#84105C] hover:before:opacity-10",id:"all-check"}),e.jsx("span",{className:"absolute text-white transition-opacity opacity-0 pointer-events-none top-2/4 left-2/4 -translate-y-2/4 -translate-x-2/4 peer-checked:opacity-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",stroke:"currentColor",strokeWidth:"1",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"})})})]})})]}),c==null?void 0:c.map(f=>{if(f!==void 0)return e.jsx(ce,{name:f.name,id:f.id},f.id)})]})})}const A=l.createContext();function ie({setOpenLocation:t,openLocation:s}){const[r,n,o]=R(),[i,d]=l.useState("استان"),[u,c]=l.useState([]),[g,p]=l.useState([]),[f,h]=l.useState(),[x,b]=l.useState(),[j,m]=l.useState([]),[a,y]=l.useState(!1),[C,k]=l.useState(!1),L=ae();l.useEffect(()=>{const _=[];L==null||L.forEach(E=>{r.cities&&r.cities.includes(E.id)&&_.push({name:E.name,id:E.id,province_id:E.province_id})}),_.length>0&&c(_),r.provinces&&p(r.provinces)},[]);const F=le(),[z,S]=l.useState();return l.useEffect(()=>{S(F)},[]),e.jsxs(A.Provider,{value:{setLocSituation:d,setAllCheckedBoxes:c,allCheckedBoxes:u,setCheck:p,setDeleteAllBtnClicked:y,setRemovedAllLocs:k,prvId:f,setPrvName:b,setSearchRes:m,locSituation:i,prvName:x,check:g,searchRes:j,setPrvId:h,setCookie:n,cookie:r,deleteAllBtnClicked:a,removeCookie:o,removedAllLocs:C,setOpenLocation:t},children:[e.jsx("div",{className:`w-full h-full fixed top-0 right-0 bg-[#00000073] z-[100000] transition-opacity duration-1000 ease-in-out  ${s}`}),e.jsx("div",{className:`w-full h-full flex flex-col items-center justify-end lg:justify-center fixed top-0 right-0   transition-all duration-1000 ease-in-out z-[1000000]  ${s.includes("invisible")?"translate-y-full":"translate-y-0"}    `,children:e.jsxs("div",{className:"w-full md:w-[75%] lg:w-[40%] h-[88%] bg-white rounded-2xl relative  z-[100000] border border-gray-50  overflow-hidden top-2 bottom-0  p-8 ",children:[e.jsxs("div",{className:" flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center border-r-4 border-pink-400 pr-2",children:[e.jsxs("div",{className:"flex",children:[i==="شهر"&&e.jsx(Ae,{title:"استان",setTitle:d,setSearchRes:m,setFieldVal:S,lastList:z}),e.jsxs("p",{className:"w-auto text-md  p-2 ",children:["انتخاب ",i]})]}),(u==null?void 0:u.length)>0&&e.jsx(Re,{})]}),(u==null?void 0:u.length)>0?e.jsx(Ke,{}):e.jsx("p",{className:"text-[11px] text-gray-300 border-r-4 border-pink-400 p-2",children:"حداقل یک شهر را انتخاب کنید"}),e.jsx(De,{})]}),(j==null?void 0:j.length)===0?i==="استان"?e.jsx(Te,{}):e.jsx(Je,{}):e.jsx(qe,{}),e.jsx(Ie,{})]})})]})}function de(t,s,r){t.cities!==void 0&&t.cities.length>0?r==null||r.map(n=>{var o;(o=n.children)==null||o.map(i=>{if(i.id==t.cities[0]){const d=t.cities.length-1;s(d?`${i.name}  و  ${d}  شهر  دیگر`:i.name)}})}):s("ایران")}const G=[{name:"جدیدترین",slug:"n",id:11111111},{name:"ارزان‌ترین",slug:"ch",id:22222222},{name:"گران‌ترین",slug:"ex",id:33333333},{name:"نزدیک‌ترین",slug:"cl",id:44444444},{name:"کم کارکردترین",slug:"lp",id:55555555},{name:"پرکارکردترین",slug:"hp",id:66666666},{name:"قدیمی‌ترین سال",slug:"oy",id:77777777},{name:"جدیدترین سال",slug:"ny",id:88888888}];function ue(t,s,r,n,o,i,d){if(s){if(n==="مرتب سازی"){const u=G.find(c=>c.name===s.title||c.name===s.name);t.set("o",u.slug),U(i.pathname,t,r)}else n==="دسته بندی"?(t.set("c",s.id),U(`/s/iran/${s.slug}`,t,r)):(t.set(o,s.id),U(`/s/iran/${d.category}`,t,r));s.name==="همه گروه ها"&&([...t.keys()].forEach(c=>{t.delete(c)}),U("/s/iran",t,r))}}function V({label:t,allList:s,defaultItem:r,queryKey:n}){const{navigateTo:o}=l.useContext(fe),[i,d]=l.useState("opacity-0 invisible"),[u,c]=l.useState([]),[g,p]=l.useState(),[f,h]=l.useState(),x=I(),b=$(),j=new URLSearchParams(b.search),m=a=>{var y,C,k,L,F,z,S;a&&(ue(j,a,o,t,n,b,x),p(a!=null&&a.title?a==null?void 0:a.title:a==null?void 0:a.name),t==="دسته بندی"&&h({name:a!=null&&a.title?a==null?void 0:a.title:a==null?void 0:a.name,slug:a==null?void 0:a.slug,id:a==null?void 0:a.id}),((y=a==null?void 0:a.brands)==null?void 0:y.length)>0&&c(a.brands),((C=a==null?void 0:a.children)==null?void 0:C.length)>0&&c(a==null?void 0:a.children),((k=a==null?void 0:a.districts)==null?void 0:k.length)>0&&c(a==null?void 0:a.districts),(((L=a==null?void 0:a.children)==null?void 0:L.length)===0&&((F=a==null?void 0:a.brands)==null?void 0:F.length)===0||(a==null?void 0:a.children)===void 0&&((a==null?void 0:a.districts)===void 0||((z=a==null?void 0:a.districts)==null?void 0:z.length)==0)||((S=a==null?void 0:a.brands)==null?void 0:S.length)>0)&&d("opacity-0 invisible"))};return l.useEffect(()=>{r&&p(r)},[r]),l.useEffect(()=>{h({name:"همه گروه ها",slug:"",id:""}),s&&c(s)},[i]),e.jsx(e.Fragment,{children:e.jsx(Fe,{label:t,listItems:t==="دسته بندی"?[f,...u]:u,defaultItem:r,type:"filter",firstItemBold:!0,setOpenList:d,openList:i,fieldVal:g,setListItems:c,setListTitle:h,handleListItems:m})})}function Q({catAttrs:t,setOpenLocation:s,navigateTo:r,searchItems:n}){return t==null?void 0:t.map((o,i)=>{if(o.order==0)return e.jsx(Me,{item:o,index:i,setOpenLocation:s,navigateTo:r,searchItems:n},i)})}function Me({item:t,setOpenLocation:s,navigateTo:r,searchItems:n}){if(t.type==1||t.type==6)return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full h-auto flex flex-col gap-4",children:[e.jsx("div",{className:"w-full  flex items-center",children:e.jsx("p",{className:"text-md",children:t.title||t.name})}),e.jsxs("div",{className:"w-full flex gap-4",children:[e.jsx("div",{className:"w-1/2 h-auto text-gray-500",children:e.jsx(M,{setOpenList:s,label:"حداقل",filedType:"text",valueType:"number",type:"filter",queryKey:`mn${t.queryKey}`,searchItem:n.get(`mn${t.queryKey}`)})}),e.jsx("div",{className:"w-1/2 h-auto  text-gray-500",children:e.jsx(M,{setOpenList:s,label:"حداکثر",filedType:"text",valueType:"number",type:"filter",queryKey:`mx${t.queryKey}`,searchItem:n.get(`mx${t.queryKey}`)})})]})]})});if(t.type==2&&t.analyticsKey!=="storeroom"&&t.analyticsKey!=="elevator"&&t.analyticsKey!=="parking"&&t.analyticsKey!=="balcony"&&t.dependency.length==0)return e.jsx(V,{label:t.name||t.title,allList:t.options,queryKey:t.queryKey});if(t.type==7)return e.jsx(re,{label:t.name||t.title,type:"filter",queryKey:t.queryKey,navigateTo:r,queryParams:n})}const fe=l.createContext();function Ve(){const[t]=R(),s=T(),n=I().category,o=JSON.parse(localStorage.getItem("ads_locations_list")),[i,d]=l.useState(""),[u,c]=l.useState(),[g,p]=l.useState(),[f,h]=l.useState([]),[x,b]=l.useState([]),[j,m]=l.useState([]),[a,y]=l.useState(1),[C,k]=l.useState("opaciti-0 invisible"),[L,F]=l.useState(),z=$(),S=new URLSearchParams(z.search);l.useEffect(()=>{de(t,v=>{d(v)},o)},[t.cities]),l.useEffect(()=>{const v=JSON.parse(localStorage.getItem("ads_categories_list"));v&&p(v)},[]),l.useEffect(()=>{g!==void 0&&n&&(g==null||g.find(v=>{var P;if(v.slug===n&&v.type!=0){const N=[...v.attributes],H=[];h(N),b(H),c(v),v.defaultSortid&&y(v.defaultSortid),v.sortOptions.length>0&&m(v.sortOptions)}(P=v.children)==null||P.find(N=>{if((N==null?void 0:N.slug)===n){const H=[...N.attributes];b(H),c(N),N.defaultSortid&&m(N.sortOptions),N.sortOptions.length>0&&m(N.sortOptions)}})}))},[n,g]),l.useEffect(()=>{x.length>0&&x.map(v=>{(v.id==="68090"||v.id==="68092")&&be(f,1)})},[x]),l.useEffect(()=>{const v=G.find(P=>P.slug===S.get("o"));j.length>0&&F(v!==void 0?v.name:j.find(P=>P.id===a).title)},[j]);const[_]=q(),E=Object.fromEntries(_.entries());return l.useEffect(()=>{W(E,S,s,z)},[n]),e.jsx(fe.Provider,{value:{navigateTo:s},children:e.jsxs("div",{className:"w-full h-auto p-6 flex flex-col gap-8 pb-[5.25rem]",children:[j.length>0&&L&&e.jsx(V,{label:"مرتب سازی",allList:j,defaultItem:L,queryKey:"o"}),e.jsx(re,{label:"فقط آگهی های عکس دار",type:"filter",queryKey:"wp",navigateTo:s,queryParams:S}),u&&e.jsx(V,{label:"دسته بندی",allList:g,defaultItem:u.name,queryKey:"c"}),e.jsx(M,{setOpenList:k,label:"استان و شهر",fieldVal:i,type:"filter"}),C&&e.jsx(ie,{setOpenLocation:k,openLocation:C}),f.length>0&&e.jsx(Q,{catAttrs:f,setOpenLocation:k,navigateTo:s,searchItems:S}),x.length>0&&e.jsx(Q,{catAttrs:x,setOpenLocation:k,navigateTo:s,searchItems:S})]})})}function We(){const{setFilterFormDisplay:t}=l.useContext(w),s=()=>{t("opacity-0 invisible")};return e.jsx("div",{onClick:s,className:"w-full h-20 absolute bottom-0 p-3 flex justify-center items-center",children:e.jsx("span",{className:"w-full h-full flex justify-center items-center bg-[#84105C] text-white cursor-pointer rounded-lg hover:opacity-[0.7] ",children:"اعمال فیلتر"})})}function Xe(){const{filterFormDisplay:t,setFilterFormDisplay:s}=l.useContext(w),r=n=>{!t.includes("invisible")&&n.target.id==="filter-box"&&s("opacity-0 invisible")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`w-full h-full flex items-center justify-center fixed top-0 right-0 z-[10000] bg-[#00000073]  transition-opacity duration-1000 ease-in-out  ${t}`}),e.jsx("div",{onClick:r,id:"filter-box",className:`w-full h-full  flex flex-col items-start justify-center fixed top-0 right-0  transition-all duration-1000 ease-in-out z-[1000000]  ${t.includes("invisible")?"translate-x-full":"translate-x-0"}    `,children:e.jsx("div",{className:"w-auto md:w-[50%] lg:w-[40%] xl:w-[30%] relative right-0 h-[100%] bg-white z-[100000] ",children:e.jsxs("div",{className:"w-full h-[99%] flex flex-col gap-5 overflow-y-scroll",children:[e.jsx(Be,{}),e.jsx(Ve,{}),e.jsx(We,{})]})})})]})}function Ge(){return e.jsx(B,{to:"/newad",children:e.jsxs("div",{className:" flex gap-2 items-center p-4 hover:opacity-[0.7] leading-3 rounded-full bg-[#84105C] cursor-pointer",children:[e.jsx(je,{color:"#ffffff",size:"size-6"}),e.jsx("p",{className:"w-auto  text-center  text-[0.8rem] text-white ",children:"ثبت آگهی رایگان"})]})})}function Qe(){var u;const[t,s]=l.useState("opacity-0 invisible"),[r]=R(),{adsList:n,setSearchedAds:o}=l.useContext(w),i=ae(),d=c=>{const g=n==null?void 0:n.data.data.filter(p=>{var f;return(f=p.title)==null?void 0:f.includes(c.target.value)});o(g)};return e.jsxs("div",{className:"w-full xl:w-[63%] h-20  flex justify-center items-center z-[10000] ",children:[e.jsxs("div",{className:"w-[95%] h-[70%] border border-gray-200 z-20 rounded-xl flex gap-2 justify-between",children:[e.jsx("input",{onChange:d,className:"outline-none w-[70%] lg:w-[93%] md:w-[85%]  h-full p-3 bg-transparent text-gray-400 placeholder-gray-300 text-[0.8rem] z-30 text-right ",placeholder:"جستجو در همه آگهی ها"}),e.jsxs("div",{className:"w-32 py-2 px-3 flex flex-row-reverse gap-1 items-center justify-around border-r-[1px]",children:[e.jsx("img",{className:"w-[28px]",src:me}),((u=r.cities)==null?void 0:u.length)>0?i==null?void 0:i.map(c=>{if(c.id==r.cities[0]){const g=r.cities.length;return e.jsx("p",{onClick:()=>s("opacity-100 visible"),className:"text-[0.8rem] text-gray-400 cursor-pointer  text-nowrap",children:g?`${g} شهر`:c.name},c.id)}}):e.jsx("p",{onClick:()=>s("opacity-100 visible"),className:"text-[0.8rem] text-gray-400 cursor-pointer text-nowrap",children:"همه ایران"})]})]}),t&&e.jsx(ie,{setOpenLocation:s,openLocation:t})]})}function Ye(){return e.jsx(B,{to:"/login",children:e.jsxs("div",{className:"flex gap-2 items-center p-4 bg-pink-50  rounded-full border border-[#84105C] cursor-pointer",children:[e.jsx(te,{color:"#84105C",size:"size-6"}),e.jsx("p",{className:"text-[0.8rem] text-[#84105C]",children:"حساب من"})]})})}function Ze(){const t=$(),s=I();return e.jsxs("div",{className:"w-full h-auto py-3  border-b-[1px] flex items-center justify-between",children:[e.jsx("div",{className:"hidden lg:flex",children:e.jsx(ke,{color:"#84105C",size:"size-8",textStyle:"text-black"})}),t.pathname!=="/newAd"&&!t.pathname.startsWith("/myAccount")&&s.id===void 0&&e.jsx(Qe,{}),e.jsxs("div",{className:"hidden xl:flex w-auto  gap-3 items-center",children:[t.pathname!=="/newAd"&&e.jsx(Ge,{}),e.jsx(Ye,{})]})]})}function et(){const{category:t,brands:s,model:r,locationUrl:n,searchParams:o}=l.useContext(w),i=K(),d=T(),u=()=>[X(document.querySelectorAll(".sub-cat-items-box"))],c=l.useMemo(()=>{if(i===void 0)return;let p=null;return i.map(f=>{var h;f.slug===t&&(p=f.children),(h=f.children)==null||h.map(x=>{var b;x.slug===t&&(p=x.brands),(b=x.brands)==null||b.map(j=>{var m;j.slug===`${t}/${s}`&&(j.attributes.length>0?(m=j.attributes)==null||m.map(a=>{p=a.options}):p=[]),n.pathname===`/s/iran/${t}/${s}/${encodeURI(r)}`&&(p=[])})})}),p},[n]),g=(p,f)=>{f.preventDefault(),p.slug!==void 0?d({pathname:`/s/iran/${p.slug}`,search:o&&o.toString()}):d({pathname:`/s/iran/${t}/${s}/${p==null?void 0:p.name}`,search:o&&o.toString()})};return e.jsx("div",{onClick:u,className:"sub-cat-items-box w-full h-auto bg-gray-50  border-b-[1px] border-t-[1px]",children:e.jsx("ul",{className:"w-auto  flex overflow-x-scroll  m-0 py-1 ",children:c==null?void 0:c.map(p=>e.jsx("li",{className:"min-w-auto flex flex-col items-center gap-2  ",children:e.jsx("a",{href:p.slug!==void 0?`/s/iran/${p.slug}`:`/s/iran/${t}/${s}/${p.name}`,onClick:f=>g(p,f),className:"w-full p-2  rounded-3xl cursor-pointer flex flex-col gap-3 justify-center items-center",children:e.jsx("p",{className:"text-[#84105C] text-[0.8rem] py-1 px-2 text-center text-nowrap",children:p.name})})},p.id))})})}function xe({setOpenList:t,navigateTo:s,openList:r,list:n,queryParams:o,lable:i,locationUrl:d,queryKey:u,setSelectedItem:c,type:g}){const[p,f]=l.useState(),[h,x]=l.useState(),b=j=>{j&&(c(j),t("opacity-0 invisible"),ue(o,j,s,i,u,d))};return l.useEffect(()=>{g==="categorySearch"&&x({name:"همه گروه ها",slug:"",id:""})},[r]),l.useEffect(()=>{n&&r&&f(h?[h,...n]:n)},[h,r]),e.jsx(e.Fragment,{children:e.jsx(ze,{type:g,lable:i,allList:p,setListItems:f,setOpenList:t,firstItemBold:!0,handleListItems:b,openList:r})})}function tt({setSortOptions:t}){const{category:s}=l.useContext(w),[r,n]=l.useState(),[o,i]=l.useState("opacity-0 invisible"),d=K(),u=T(),c=$(),g=new URLSearchParams(c.search),[p]=q(),f=Object.fromEntries(p.entries());l.useEffect(()=>{d!==void 0&&d.map(x=>{var b;x.slug===s&&(n({id:x.id,name:x.name,slug:x.slug}),t(x.sortOptions)),(b=x.children)==null||b.map(j=>{j.slug===s&&(n({id:j.id,name:j.name,slug:j.slug}),t(j.sortOptions))})})},[c]);const h=()=>{i("opacity-100 visible")};return l.useEffect(()=>{W(f,g,u,c)},[s]),e.jsxs(e.Fragment,{children:[e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]",lable:r==null?void 0:r.name,handleAction:h,icon:e.jsx(ve,{color:"#84105C",size:"size-5",strokeWidth:"2"})}),o&&e.jsx(xe,{setOpenList:i,openList:o,navigateTo:u,list:d,queryParams:g,lable:"دسته بندی",locationUrl:c,queryKey:"c",type:"categorySearch",setSelectedItem:n})]})}function st(){const{setFilterFormDisplay:t}=l.useContext(w),s=()=>{t("opacity-100 visible")};return e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-[#84105C]",textColor:"text-[#ffffff]",lable:"فیلتر",handleAction:s,icon:e.jsx(ye,{color:"#ffffff",size:"size-6"})})}function Y({lable:t,slug:s}){const{locationUrl:r,navigateTo:n}=l.useContext(w),o=s.split("/"),i=()=>{const d=new URLSearchParams(r.search);o.length>1?n({pathname:`/s/iran/${o[0]}`,search:d.toString()}):(s&&d.delete(s),n({pathname:r.pathname,search:d.toString()}))};return e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]",lable:t,icon:e.jsx(Ce,{handleDisplaySlug:i,color:"#84105C",size:"size-6"})})}function rt(t,s){t.includes("mxp")&&s.push({id:0,title:"حداکثر قیمت",slug:t}),t.includes("mnp")&&s.push({id:0,title:"حداقل قیمت",slug:t})}function Z(t,s,r,n){t.startsWith("mn")?s.push({id:r,title:`حداقل  ${n.title}`,slug:t}):t.startsWith("mx")?s.push({id:r,title:`حداکثر  ${n.title}`,slug:t}):s.push({id:r,title:`${n.title}`,slug:t})}function nt({sortOptions:t,searchObject:s}){const[r,n]=l.useState("opacity-0 invisible"),o=T(),i=$(),d=new URLSearchParams(i.search),[u,c]=l.useState({name:"جدیدترین",slug:"n",id:11111111}),g=()=>{r.includes("invisible")?n("opacity-1 visible"):n("opacity-0 invisible")};return l.useEffect(()=>{G.map(p=>{p.slug===s.o&&c(p)})},[i]),e.jsxs(e.Fragment,{children:[e.jsx(O,{borderColor:"border-[#84105C]",bgColor:"bg-pink-50",textColor:"text-[#84105C]",lable:u==null?void 0:u.name,handleAction:g,icon:e.jsx(we,{color:"#84105C",size:"size-5",strokeWidth:"2"})}),r&&t&&e.jsx(xe,{setOpenList:n,openList:r,navigateTo:o,list:t,queryParams:d,lable:"مرتب سازی",locationUrl:i,queryKey:"o",setSelectedItem:c})]})}function lt(t,s){t.includes("wp")&&s.push({id:-1,title:"آگهی های عکس دار",slug:t})}function ot(){const{category:t,brands:s,model:r,locationUrl:n}=l.useContext(w),o=()=>{X(document.querySelectorAll(".filtered-item-box"))},[i]=q(),d=Object.fromEntries(i.entries()),u=K(),c=l.useMemo(()=>{let h=null;return u==null||u.map(x=>{var b;x.name==="وسایل نقلیه"&&((b=x.children)==null||b.forEach(j=>{j.brands.forEach(m=>{s!==void 0&&m.slug===`${t}/${s}`&&(h=r!==void 0?{id:m.id,title:`${m.name}   /   ${r}`,slug:`${m.slug}/${r}`}:{id:m.id,title:m.name,slug:m.slug})})}))}),h},[n]),g=l.useMemo(()=>{let h=[];for(let x in d){if(x!=="c"&&x!=="cities"){const b=x.match(/\d+/g);u==null||u.map(j=>{var m;j.attributes.map(a=>{a.id==b&&Z(x,h,b,a)}),(m=j.children)==null||m.map(a=>{var y;(y=a.attributes)==null||y.map(C=>{C.id==b&&Z(x,h,b,C)})})})}rt(x,h),lt(x,h)}return h},[n]),[p,f]=l.useState();return e.jsx("div",{className:"w-[99%] h-14 ",children:e.jsx("div",{onClick:o,className:"w-full h-full  filtered-item-box overflow-x-scroll ul-box",children:e.jsxs("ul",{id:"places-category-ul",className:"w-auto   px-1 flex gap-1 m-0",children:[e.jsx(st,{}),e.jsx(nt,{sortOptions:p,searchObject:d}),e.jsx(tt,{setSortOptions:f}),c&&e.jsx(Y,{lable:c==null?void 0:c.title,slug:c==null?void 0:c.slug},c==null?void 0:c.id),g==null?void 0:g.map((h,x)=>e.jsx(Y,{lable:h.title,slug:h.slug},h.id*x))]})})})}function pe(){const[t]=R(),s=JSON.parse(localStorage.getItem("ads_locations_list")),[r,n]=l.useState("ایران");return l.useEffect(()=>{de(t,o=>{n(o)},s)},[t.cities]),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("p",{className:"text-[0.8rem]",children:"همه آگهی های"}),e.jsx("p",{className:"text-[0.8rem]",children:r})]})}function at(){const{brandAndModel:t,category:s,locationUrl:r}=l.useContext(w),n=JSON.parse(localStorage.getItem("ads_categories_list")),[o,i]=l.useState([]);return l.useEffect(()=>{n!==void 0&&n.map(d=>{var u;s===d.slug?i([{id:d.id,name:d.name,slug:d.slug}]):(u=d.children)==null||u.map(c=>{c.slug===s&&i([{id:d.id,name:d.name,slug:d.slug},{id:c.id,name:c.name,slug:c.slug}])})})},[r]),e.jsxs("div",{className:"w-full h-auto flex gap-1  p-3 py-4 border-b-[1px] border-t-[1px] items-center ",children:[e.jsx(pe,{}),e.jsx(D,{color:"#000000",size:"size-4"}),e.jsx(J,{breadItem:o[0]}),o[1]!==void 0&&e.jsx(D,{color:"#000000",size:"size-4"}),e.jsx(J,{breadItem:o[1]}),t!==void 0&&e.jsx(D,{color:"#000000",size:"size-4"}),e.jsx(J,{breadItem:t})]})}function J({breadItem:t}){return e.jsx("div",{className:"w-auto h-full flex items-center justify-center",children:e.jsx(B,{to:`/s/iran/${t==null?void 0:t.slug}`,className:"w-full h-full outline-none flex gap-1 items-center cursor-pointer",children:e.jsx("p",{className:"text-[0.8rem] text-black",children:(t==null?void 0:t.name)||(t==null?void 0:t.title)})})})}const ct=async(t,s)=>{const r="http://127.0.0.1:3000";try{return await se.get(`${r}/api/ads/s/${t}?${s}`)}catch(n){return n}},it=async()=>{const t="http://127.0.0.1:3000";try{return await se.get(`${t}/api/ads/`)}catch(s){console.log(s)}},w=l.createContext();function dt(){var a;$e();const t=T(),s=I(),r=$(),[n]=R(),[o,i]=l.useState("opacity-0 invisible"),[d,u]=l.useState(),c=s.category,g=s.brands,p=s.model,f=new URLSearchParams(r.search),h={};for(const[y,C]of f.entries())h[y]=C;const x=encodeURIComponent(JSON.stringify(n.cities)),{data:b,isLoading:j}=Oe({queryKey:["ads",c,h],queryFn:c||Object.keys(h).length>0?async()=>await ct(c,f):async()=>await it(),keepPreviousData:!0});l.useEffect(()=>{if(n.cities!==void 0&&n.cities.length>0)f.set("cities",x),U(r.pathname,f,t);else{f.delete("cities");const y=r.pathname.includes("/s/iran")?r.pathname:"s/iran";U(y,f,t)}},[x]);const m=K();return l.useEffect(()=>{if(localStorage.setItem("last-url-pathname",r.pathname),localStorage.setItem("last-url-search",r.search),!!r.pathname.includes("/s/iran"))if(!c)document.title="شیپورچی مرجع نیازمندی های سرتاسر ایران";else{const y=m==null?void 0:m.find(C=>C.slug===c);y!==void 0&&(document.title=`اگهی های مربوط یه ${y==null?void 0:y.name}`)}},[r]),e.jsxs(w.Provider,{value:{filterFormDisplay:o,setFilterFormDisplay:i,category:c,brands:g,model:p,locationUrl:r,navigateTo:t,searchParams:f,setSearchedAds:u,adsList:b,cookieCitiesInUrl:x},children:[j&&e.jsx(Se,{}),e.jsxs("div",{className:"w-[98%] sm:w-[87%] h-full absolute flex flex-col gap-6 items-center mb-14  p-2",children:[e.jsx(Ze,{}),c&&e.jsxs(e.Fragment,{children:[e.jsx(Xe,{}),e.jsx(ot,{}),e.jsx(et,{}),e.jsx(at,{})]}),c===void 0&&e.jsxs(e.Fragment,{children:[e.jsx(Pe,{}),e.jsxs("div",{className:"w-[98%] h-auto p-4 flex flex-row gap-3 justify-start items-center border-t-[1px] border-b-[1px] ",children:[e.jsx(ee,{color:"#84105C",size:"size-7"}),e.jsx(pe,{})]})]}),e.jsx(Ue,{adsList:d||((a=b==null?void 0:b.data)==null?void 0:a.data)})]}),e.jsx(Ee,{})]})}const bt=Object.freeze(Object.defineProperty({__proto__:null,HomeContext:w,default:dt},Symbol.toStringTag,{value:"Module"}));export{Ze as H,Ee as N,bt as a,X as s};
