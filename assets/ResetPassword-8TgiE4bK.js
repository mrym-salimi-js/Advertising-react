import{r as t,u as h,b as w,j as n,a as y,n as x}from"./index-BHv6j6MZ.js";import{a as T,b as j}from"./TextComponent-Wnb24qUz.js";import{A as k}from"./AuthForm-CmrCqmtf.js";import{N as L}from"./NotifToast-DJvUOUJ0.js";import"./Logo-DcXDr996.js";import"./SpinnerLoading-mYyqj2-X.js";function V(){const s=t.useRef([]),[o,i]=t.useState(),m=h(),u=w(),[f,c]=t.useState(!1),v="http://127.0.0.1:3000",[d,l]=t.useState({message:"",status:""}),[p,g]=t.useState();t.useEffect(()=>{document.title="ساخت رمز عبور جدید"},[]);const b=async()=>{var r;(r=s==null?void 0:s.current)==null||r.map(a=>{a.value===""?T(e=>{i(e)},a.getAttribute("data-label"),a.value,o,a.type):g(a.value)})};return t.useEffect(()=>{var a;const r=async()=>{try{c(!0);const e=await y.post(`${v}/resetPassword/${u.token}`,{password:s==null?void 0:s.current[0].value,passwordConfirm:s==null?void 0:s.current[1].value},{headers:{Authorization:`Bearer ${u.token}`}});e!==void 0&&(e.data.status==="success"&&l({message:"رمز عبور شما تغییر کرد",status:"success"}),j.remove("user-pass"),x("/login","",m))}catch(e){c(!1),e&&l({message:"رمز عبور موقتی وجود ندارد یا منقضی شده",status:"fail"})}};p&&(o&&((a=Object==null?void 0:Object.keys(o))==null?void 0:a.length)==0||o===void 0)&&r()},[p]),n.jsxs(n.Fragment,{children:[d.message&&n.jsx(L,{setNotif:l,notif:d}),n.jsx(k,{fieldes:[{label:"رمز عبور",type:"password",valueType:"password"},{label:"تکرار رمز عبور",type:"password",valueType:"password"}],handleBtn:b,headerLabel:"ساخت رمز عبور جدید",inputRefs:s,validation:o,setValidation:i,loading:f,otherLink:[{label:"فراموشی رمز عبور!",link:"/forgetPassword"}],btnLabel:"ارسال"})]})}export{V as default};
